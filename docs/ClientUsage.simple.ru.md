# Как работает клиент Random (пошаговое объяснение)

Этот документ объясняет работу клиента понятным языком, без кода, но по шагам.

## Общая идея

Клиент регулярно отправляет в смарт‑контракт Random данные о случайности. Он делает это в два шага:

- сначала **обещает** данные (commit),
- потом **раскрывает** их (reveal).

Так система может проверить честность: нельзя подменить данные после обещания.

## Пошаговый процесс

### Шаг 1. Подготовка случайности

Клиент получает случайные биты от операционной системы (как «источник случайности»).
Из этих битов он делает две вещи:

- **revealedBits** — сами случайные биты,
- **committedDigest** — «отпечаток» этих битов (короткая проверочная строка).

### Шаг 2. Commit (обещание)

Клиент отправляет в контракт **только отпечаток** (digest). Сами биты пока не раскрываются.
Это похоже на запечатанный конверт: контракт знает, что вы зафиксировали данные, но не видит их.

### Шаг 3. Ожидание нескольких тиков

Контракт требует паузу между обещанием и раскрытием. Клиент ждёт несколько тиков сети.
По умолчанию это **3 тика**.

### Шаг 4. Reveal (раскрытие)

Клиент отправляет:

- предыдущие **revealedBits** (то, что обещал раньше),
- и **новый committedDigest** для следующего цикла.

Контракт проверяет: совпадает ли раскрытие с ранее обещанным отпечатком.
Если совпадает — всё хорошо, цикл считается честным.

### Шаг 5. Новый цикл

Сразу после reveal начинается новый цикл:

- только что отправленный digest становится «обещанием» для следующего reveal,
- клиент снова ждёт несколько тиков,
- затем раскрывает и отправляет следующий digest.

Так получается непрерывная цепочка.

## Что делает клиент постоянно

Пока клиент запущен, он делает три параллельные вещи:

1) **Следит за тиком** — чтобы понимать, когда отправлять commit и reveal.
2) **Отправляет транзакции** — по расписанию (commit/reveal).
3) **Следит за балансом** — если баланс ниже депозита, работа останавливается, чтобы не терять средства.

## Что будет при остановке клиента

Если есть «незакрытое обещание», клиент пытается отправить reveal перед выходом.
Это нужно, чтобы не потерять депозит из‑за пропуска.

## Что нужно от пользователя

- Seed — секретная строка из 55 букв a‑z.
- Достаточный баланс для депозита.
- Запущенный клиент, чтобы reveal приходили вовремя.